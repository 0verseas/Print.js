!function(e,t){"use strict";function r(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}var i={printable:null,type:"pdf",header:null,maxWidth:800,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,properties:null,showModal:!1,modalMessage:"Retrieving Document...",frameId:"printJS"},n="max-width: "+i.maxWidth+"px !important;"+i.font_size+" !important;",o="font-family:"+i.font+"; font-size: "+i.font_size+" !important;",s="font-weight:300;",p=t.getElementsByTagName("body")[0];e.printJS=function(){return void 0===arguments[0]?(e.console.error("printJS expects at least 1 attribute."),!1):void new d(arguments)};var d=function(){var e=arguments[0],a=this;switch(a.params=r({},i),typeof e[0]){case"string":a.params.printable=encodeURI(e[0]),a.params.type=e[1]||i.type;break;case"object":a.params.printable=e[0].printable,a.params.type=e[0].type||i.type,a.params.frameId=e[0].frameId||i.frameId,a.params.header=e[0].header||i.header,a.params.maxWidth=e[0].maxWidth||i.maxWidth,a.params.font=e[0].font||i.font,a.params.font_size=e[0].font_size||i.font_size,a.params.honorMarginPadding="undefined"!=typeof e[0].honorMarginPadding?e[0].honorMarginPadding:i.honorMarginPadding,a.params.properties=e[0].properties||i.properties,a.params.showModal="undefined"!=typeof e[0].showModal?e[0].showModal:i.showModal,a.params.modalMessage=e[0].modalMessage||i.modalMessage;break;default:throw new Error('Unexpected type of argument! Expected "string" or "object", got '+typeof e[0])}a.params.showModal&&a.showModal();var n=t.getElementById(a.params.frameId);switch(n&&n.parentNode.removeChild(n),a.printFrame=t.createElement("iframe"),a.printFrame.setAttribute("style","display:none;"),a.printFrame.setAttribute("id",a.params.frameId),a.params.type){case"pdf":a.pdf();break;case"image":a.image();break;case"html":a.html();break;case"json":a.json();break;default:throw new Error("Invalid printable type")}};d.prototype.pdf=function(){this.printFrame.setAttribute("src",this.params.printable),this.send(this.printFrame,this.params)},d.prototype.image=function(){var r=t.createElement("img");r.setAttribute("style","width:100%;"),r.src=this.params.printable;var a=new Promise(function(t,a){function i(){r.complete&&(e.clearInterval(n),t("Image loaded. Read to print!"))}var n=setInterval(i,100)}),i=this;a.then(function(e){var a=t.createElement("div");a.setAttribute("style","width:100%"),a.appendChild(r),i.params.header&&i.addHeader(a),i.printFrame.setAttribute("srcdoc",a.outerHTML),i.send(i.printFrame,i.params)})},d.prototype.html=function(){var r=t.getElementById(this.params.printable);if(!r)return e.console.error("Invalid HTML element id: "+this.params.printable),!1;var a=t.createElement("div");a.appendChild(r.cloneNode(!0)),a.setAttribute("style","display:none;"),a.setAttribute("id","printJS-html"),r.parentNode.appendChild(a),a=t.getElementById("printJS-html"),a.setAttribute("style",this.collectStyles(a,this.params)+"margin:0 !important;");var i=a.children;this.loopNodesCollectStyles(i,this.params),this.params.header&&this.addHeader(a),this.printFrame.srcdoc=a.innerHTML,a.parentNode.removeChild(a),this.send(this.printFrame,this.params)},d.prototype.json=function(){var e=this;if(!e.params.printable||"object"!=typeof e.params.printable)throw new Error("Invalid javascript data object (JSON).");if(!e.params.properties||"object"!=typeof e.params.properties)throw new Error("Invalid properties array for your JSON data.");var t="";e.params.header&&(t+='<h1 style="'+s+'">'+e.params.header+"</h1>"),t+=e.jsonToHTML(),e.printFrame.setAttribute("srcdoc",t),e.send(e.printFrame,e.params)},d.prototype.send=function(){p.appendChild(this.printFrame);var e=this.params.frameId,r=this.params.type;this.printFrame.onload=function(){var a=t.getElementById(e);if("html"==r||"json"==r){var i=a.contentDocument;i.body.style=o}a.focus(),a.contentWindow.print()},this.params.showModal&&this.disablePrintModal()},d.prototype.collectStyles=function(r){var a=t.defaultView||e,i=[],o="";if(a.getComputedStyle){i=a.getComputedStyle(r,"");for(var s=0;s<i.length;s++)"font-family"!=i[s]&&-1===i[s].indexOf("animation")&&-1===i[s].indexOf("background")&&-1===i[s].indexOf("image")&&-1===i[s].indexOf("transition")&&-1===i[s].indexOf("text-fill")&&(this.params.honorMarginPadding?o+=i[s]+":"+i.getPropertyValue(i[s])+";":-1===i[s].indexOf("margin")&&-1===i[s].indexOf("padding")&&(o+=i[s]+":"+i.getPropertyValue(i[s])+";"))}else if(r.currentStyle){i=r.currentStyle;for(var p in i)"font-family"!=i&&-1===i.indexOf("animation")&&-1===i.indexOf("background")&&-1===i.indexOf("image")&&-1===i.indexOf("transition")&&-1===i[s].indexOf("text-fill")&&(o+=p+":"+i[p]+";")}return o+=n},d.prototype.loopNodesCollectStyles=function(e){for(var t=0;t<e.length;t++){var r=e[t];r.setAttribute("style",this.collectStyles(r));var a=r.children;a.length&&this.loopNodesCollectStyles(a)}},d.prototype.addHeader=function(e){var r=t.createElement("h1"),a=t.createTextNode(this.params.header);r.appendChild(a),r.setAttribute("style",s),e.insertBefore(r,e.childNodes[0])},d.prototype.jsonToHTML=function(){var e=this.params.printable,t=this.params.properties,r='<div style="display:flex; flex-direction: column;">';r+='<div style="flex:1; display:flex;">';for(var i=0;i<t.length;i++)r+='<div style="flex:1; padding:5px;">'+a(t[i])+"</div>";r+="</div>";for(var n=0;n<e.length;n++){r+='<div style="flex:1; display:flex; border:1px solid lightgray;">';for(var o=0;o<t.length;o++)r+='<div style="flex:1; padding:5px;">'+e[n][t[o]]+"</div>";r+="</div>"}return r+="</div>"},d.prototype.showModal=function(){var e="font-family:sans-serif; display:flex; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:absolute; color: #0460B5; width: 100%; height: 100%; background-color:rgba(255, 255, 255, 0.91);",r=t.createElement("div");r.setAttribute("style",e),r.setAttribute("id","printJS-Modal");var a=t.createElement("div");a.setAttribute("style","flex:1; margin:auto;");var i=t.createElement("span");i.setAttribute("class","printSpinner"),a.appendChild(i);var n=t.createTextNode(this.params.modalMessage);a.appendChild(n),r.appendChild(a),p.appendChild(r)},d.prototype.disablePrintModal=function(){var e=t.getElementById("printJS-Modal");e.parentNode.removeChild(print.printFrame)}}(window,document);
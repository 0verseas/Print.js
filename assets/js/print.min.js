!function(t,e){"use strict";function r(t){return'<div style="'+s+'">'+t+"</div>"}function a(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function i(t){return t.charAt(0).toUpperCase()+t.slice(1)}var n={printable:null,type:"pdf",header:null,maxWidth:800,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,properties:null,showModal:!1,modalMessage:"Retrieving Document...",frameId:"printJS"},o="max-width: "+n.maxWidth+"px !important;"+n.font_size+" !important;",s="font-family:"+n.font+" !important; font-size: "+n.font_size+" !important; width:100%;",p="font-weight:300;",d=e.getElementsByTagName("body")[0];t.printJS=function(){return void 0===arguments[0]?(t.console.error("printJS expects at least 1 attribute."),!1):void new l(arguments)};var l=function(){var t=arguments[0],r=this;switch(r.params=a({},n),typeof t[0]){case"string":r.params.printable=encodeURI(t[0]),r.params.type=t[1]||n.type;break;case"object":r.params.printable=t[0].printable,r.params.type=t[0].type||n.type,r.params.frameId=t[0].frameId||n.frameId,r.params.header=t[0].header||n.header,r.params.maxWidth=t[0].maxWidth||n.maxWidth,r.params.font=t[0].font||n.font,r.params.font_size=t[0].font_size||n.font_size,r.params.honorMarginPadding="undefined"!=typeof t[0].honorMarginPadding?t[0].honorMarginPadding:n.honorMarginPadding,r.params.properties=t[0].properties||n.properties,r.params.showModal="undefined"!=typeof t[0].showModal?t[0].showModal:n.showModal,r.params.modalMessage=t[0].modalMessage||n.modalMessage;break;default:throw new Error('Unexpected type of argument! Expected "string" or "object", got '+typeof t[0])}r.params.showModal&&r.showModal();var i=e.getElementById(r.params.frameId);switch(i&&i.parentNode.removeChild(i),r.printFrame=e.createElement("iframe"),r.printFrame.setAttribute("style","display:none;"),r.printFrame.setAttribute("id",r.params.frameId),r.params.type){case"pdf":r.pdf();break;case"image":r.image();break;case"html":r.html();break;case"json":r.json();break;default:throw new Error("Invalid printable type")}};l.prototype.pdf=function(){this.printFrame.setAttribute("src",this.params.printable),this.print(this.printFrame,this.params)},l.prototype.image=function(){var r=e.createElement("img");r.setAttribute("style","width:100%;"),r.src=this.params.printable;var a=new Promise(function(e,a){function i(){r.complete&&(t.clearInterval(n),e("Image loaded. Read to print!"))}var n=setInterval(i,100)}),i=this;a.then(function(t){var a=e.createElement("div");a.setAttribute("style","width:100%"),a.appendChild(r),i.params.header&&i.addHeader(a),i.printFrame.setAttribute("srcdoc",a.outerHTML),i.print(i.printFrame,i.params)})},l.prototype.html=function(){var a=e.getElementById(this.params.printable);if(!a)return t.console.error("Invalid HTML element id: "+this.params.printable),!1;var i=e.createElement("div");i.appendChild(a.cloneNode(!0)),i.setAttribute("style","display:none;"),i.setAttribute("id","printJS-html"),a.parentNode.appendChild(i),i=e.getElementById("printJS-html"),i.setAttribute("style",this.collectStyles(i,this.params)+"margin:0 !important;");var n=i.children;this.loopNodesCollectStyles(n,this.params),this.params.header&&this.addHeader(i),this.printFrame.srcdoc=r(i.innerHTML),i.parentNode.removeChild(i),this.print(this.printFrame,this.params)},l.prototype.json=function(){if(!this.params.printable||"object"!=typeof this.params.printable)throw new Error("Invalid javascript data object (JSON).");if(!this.params.properties||"object"!=typeof this.params.properties)throw new Error("Invalid properties array for your JSON data.");var t="";this.params.header&&(t+='<h1 style="'+p+'">'+this.params.header+"</h1>"),t+=this.jsonToHTML(),t=r(t),this.printFrame.setAttribute("srcdoc",t),this.print(this.printFrame,this.params)},l.prototype.print=function(){d.appendChild(this.printFrame);var t=this.params.frameId;this.params.type;this.printFrame.onload=function(){var r=e.getElementById(t);r.focus(),r.contentWindow.print()},this.params.showModal&&this.disablePrintModal()},l.prototype.collectStyles=function(r){var a=e.defaultView||t,i=[],n="";if(a.getComputedStyle){i=a.getComputedStyle(r,"");for(var s=0;s<i.length;s++)"font-family"!=i[s]&&-1===i[s].indexOf("animation")&&-1===i[s].indexOf("background")&&-1===i[s].indexOf("image")&&-1===i[s].indexOf("transition")&&-1===i[s].indexOf("text-fill")&&(this.params.honorMarginPadding?n+=i[s]+":"+i.getPropertyValue(i[s])+";":-1===i[s].indexOf("margin")&&-1===i[s].indexOf("padding")&&(n+=i[s]+":"+i.getPropertyValue(i[s])+";"))}else if(r.currentStyle){i=r.currentStyle;for(var p in i)"font-family"!=i&&-1===i.indexOf("animation")&&-1===i.indexOf("background")&&-1===i.indexOf("image")&&-1===i.indexOf("transition")&&-1===i[s].indexOf("text-fill")&&(n+=p+":"+i[p]+";")}return n+=o},l.prototype.loopNodesCollectStyles=function(t){for(var e=0;e<t.length;e++){var r=t[e];r.setAttribute("style",this.collectStyles(r));var a=r.children;a.length&&this.loopNodesCollectStyles(a)}},l.prototype.addHeader=function(t){var r=e.createElement("h1"),a=e.createTextNode(this.params.header);r.appendChild(a),r.setAttribute("style",p),t.insertBefore(r,t.childNodes[0])},l.prototype.jsonToHTML=function(){var t=this.params.printable,e=this.params.properties,r='<div style="display:flex; flex-direction: column;">';r+='<div style="flex:1; display:flex;">';for(var a=0;a<e.length;a++)r+='<div style="flex:1; padding:5px;">'+i(e[a])+"</div>";r+="</div>";for(var n=0;n<t.length;n++){r+='<div style="flex:1; display:flex; border:1px solid lightgray;">';for(var o=0;o<e.length;o++)r+='<div style="flex:1; padding:5px;">'+t[n][e[o]]+"</div>";r+="</div>"}return r+="</div>"},l.prototype.showModal=function(){var t="font-family:sans-serif; display:flex; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:absolute; color: #0460B5; width: 100%; height: 100%; background-color:rgba(255, 255, 255, 0.91);",r=e.createElement("div");r.setAttribute("style",t),r.setAttribute("id","printJS-Modal");var a=e.createElement("div");a.setAttribute("style","flex:1; margin:auto;");var i=e.createElement("span");i.setAttribute("class","printSpinner"),a.appendChild(i);var n=e.createTextNode(this.params.modalMessage);a.appendChild(n),r.appendChild(a),d.appendChild(r)},l.prototype.disablePrintModal=function(){var t=e.getElementById("printJS-Modal");t.parentNode.removeChild(print.printFrame)}}(window,document);